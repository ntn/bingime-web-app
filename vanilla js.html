<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Bingime</title>
  </head>
  <body>
    <h1>Bingime</h1>

    <div class="wrapper">

      <div class="controls">
        <form>
          <p>
            <label for="search">Enter a search term (at least 3 characters): </label>
            <input type="text" id="search" class="search" required>
          </p>
            <button class="submit">Submit search</button>
          <p id="demo">
          </p>
          </p>
        </form>
      </div>


        <section>
        </section>
      </div>

    </div>

    <script>

      // Defining a baseURL and key to as part of the request URL

      var baseURL = 'http://api.jikan.moe/search/anime/';
      var url;

      // Grab references to all the DOM elements you'll need to manipulate

      var searchTerm = document.querySelector('.search');
      var searchForm = document.querySelector('form');
      var submitBtn = document.querySelector('.submit');


      var section = document.querySelector('section');
        
      searchForm.addEventListener('submit', fetchResults);
      function fetchResults(e) {
          // Use preventDefault() to stop the form submitting
          e.preventDefault();
          
          // Assemble full URL
          url = baseURL + searchTerm.value;
          
          var request = new XMLHttpRequest();

          request.open('GET', url);
          request.responseType = "json"

          request.onreadystatechange = function () {
              if (this.readyState === 4) {
                console.log('Status:', this.status);
                console.log('Headers:', this.getAllResponseHeaders());
                console.log('Body:', this.response);
                // var myJSON = JSON.stringify(.);
                var results = this.response["result"]
                var titles = document.createElement('p');
                for (var i = 0; i < results.length; i++){
                	// document.add(results[i]["title"] + "\n");
                	titles.appendChild(document.createTextNode(results[i]["title"] + "\n"));
                	document.getElementById("demo").appendChild(titles);
                	// document.getElementById("demo").appendChild(document.createTextNode("<br>" + results[i]["title"] + "</br>"));
                }
              }
            };

          request.send();
      }

    </script>


  </body>
</html>